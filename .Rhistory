theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "khaki", #mid = "#ff8c00",
high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "khaki", mid = "#ff8c00", high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "yellow", mid = "#ff8c00", high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "khaki", mid = "#ff8c00", high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "khaki1", mid = "#ff8c00", high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points", low = "#ffffb2", mid = "#ff8c00", high = "indianred4", midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(stringr)
library(ggplot2)
library(forcats)
library(maps)
library(ggthemes)
wcmatches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/wcmatches.csv')
worldcups <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv')
americas <- c("Uruguay", "Brazil", "Chile", "Mexico", "Argentina", "United States")
europe <- c("Italy", "France", "Switzerland", "Sweden", "England", "Germany", "Spain", "West Germany", "Netherlands", "Austria", "Belgium", "Croatia", "Czechoslovakia", "Hungary", "Poland", "Portugal", "Yugoslavia", "Bulgaria", "Soviet Union", "Turkey", "Russia")
others <- c("South Africa", "Japan", "South Korea", "Japan, South Korea")
worldcups_tidy <- worldcups %>%
pivot_longer(winner:fourth, names_to = "position_status", values_to = "country_name") %>%
rename(host_country = host) %>%
mutate(host_country = ifelse(host_country == "USA", "United States", host_country),
country_name = ifelse(country_name == "USA", "United States", country_name)) %>% mutate(host_continent = case_when(
host_country %in% americas ~ "Americas",
host_country %in% europe ~ "Europe",
host_country %in% others ~ "Rest Of World"),
country_continent = case_when(
country_name %in% americas ~ "Americas",
country_name %in% europe ~ "Europe",
country_name %in% others ~ "Rest Of World"))
wcmatches_tidy <- wcmatches %>%
rename(stage_status = stage, win_outcome = outcome) %>%
mutate(stage_status = ifelse(str_detect(stage_status, "Group"), "Group Stage", stage_status),
stage_status = ifelse(stage_status == "Final Round", "Finals", stage_status)) %>%
select(-date) %>%
mutate(win_outcome = case_when(
home_score == away_score ~ "Draw",
win_outcome == "H" ~ "Home",
win_outcome == "D" ~ "Draw",
win_outcome == "A" ~ "Away")) %>%
mutate(score_difference = abs(home_score - away_score),
win_conditions = replace_na(win_conditions, "Nil"),
after_extra_time = ifelse(str_detect(win_conditions, "AET"), 1, 0),
penalties = ifelse(str_detect(win_conditions, "penalties"), 1, 0))
wcmatches_updated <- wcmatches_tidy %>%
mutate(win_outcome = ifelse(penalties == 1, "Draw", win_outcome)) %>%
select(home_team, away_team, win_outcome)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country) %>%
group_by(country) %>%
summarise(win_points = 3 * n())
wcmatches_draws <- wcmatches_updated %>%
filter(win_outcome == "Draw") %>%
pivot_longer(home_team:away_team) %>%
rename(country = value) %>%
select(country) %>%
group_by(country) %>%
summarise(draw_points = n())
home_countries <- wcmatches_tidy %>%
select(home_team) %>%
distinct() %>%
rename(country = home_team)
away_countries <- wcmatches_tidy %>%
select(away_team) %>%
distinct() %>%
rename(country = away_team)
wcmatches_allcountries <- rbind(home_countries, away_countries) %>%
distinct()
wcmatches_tabulated <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
full_join(wcmatches_allcountries, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
country == "Dutch West Indies" ~ "Indonesia",
country == "Zaire" ~ "Democratic Republic of the Congo",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion) %>%
filter(region != "Antarctica")
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") +
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points), data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
View(world_coordinates)
View(top_countries_joined)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group, fill = fill))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white")
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
#geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white")
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "white") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
?scale_fill_gradient2
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "grey50") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
home_countries <- wcmatches_tidy %>%
select(home_team) %>%
distinct() %>%
rename(country = home_team)
away_countries <- wcmatches_tidy %>%
select(away_team) %>%
distinct() %>%
rename(country = away_team)
wcmatches_allcountries <- rbind(home_countries, away_countries) %>%
distinct()
wcmatches_tabulated <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
full_join(wcmatches_allcountries, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
country == "Dutch West Indies" ~ "Indonesia",
country == "Zaire" ~ "Democratic Republic of the Congo",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion) %>%
filter(region != "Antarctica")
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "yellow", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
View(top_countries_joined)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
region == "Ireland" ~ "Republic of Ireland",
.default = region)) %>%
select(-subregion) %>%
filter(region != "Antarctica")
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
geom_polygon(data = subset(top_countries_joined, total_points == 0), fill = "#ffffb2") +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradient2(name = "Total Points",
low = "#ffffb2", mid = "#ff8c00", high = "indianred4",
midpoint = 125, na.value = "white") + #YlOrRd palette
borders(database = "world", regions = ".", fill = NA, colour = "black", size = 0.1) +
theme_map() +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank(),
axis.line = element_blank(), panel.border = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 100)
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
top_countries_joined %>% is.na()
top_countries_joined %>% filter(total_points == NA)
top_countries_joined %>% filter(total_points == "NA")
top_countries_joined %>% filter(long == NA)
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_coordinates, by = c("country" = "region"))
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
region == "Ireland" ~ "Republic of Ireland",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion) %>%
filter(region != "Antarctica")
wcmatches_updated <- wcmatches_tidy %>%
mutate(win_outcome = ifelse(penalties == 1, "Draw", win_outcome)) %>%
select(home_team, away_team, win_outcome)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country) %>%
group_by(country) %>%
summarise(win_points = 3 * n())
View(wcmatches_wins)
wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country)
View(wcmatches_wins)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team))
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away"))
wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away"))
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away"))
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team))
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country)
View(home_countries)
View(wcmatches_allcountries)
