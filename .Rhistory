top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country")) %>%
filter(region == "UK")
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country")) %>%
filter(region == "UK")
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country")) %>%
filter(region == "UK")
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
View(wcmatches_tabulated_two)
View(top_countries_joined)
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group), size = 0.25) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group), size = 0.5) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points), size = 0.3) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points), linewidth = 0.3) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points), linewidth = 0.3) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
library(readr)
root_url <- 'https://raw.githubusercontent.com/'
intermediate <- 'rfordatascience/tidytuesday/master/data/2022/2022-11-29/'
wcmatches <- read_csv(paste0(root_url, intermediate, 'wcmatches.csv'))
worldcups <- read_csv(paste0(root_url, intermediate, 'worldcups.csv'))
library(tidyverse)
library(stringr)
americas <- c("Uruguay", "Brazil", "Chile", "Mexico", "Argentina", "United States")
europe <- c("Italy", "France", "Switzerland", "Sweden", "England", "Germany", "Spain", "West Germany", "Netherlands", "Austria", "Belgium", "Croatia", "Czechoslovakia", "Hungary", "Poland", "Portugal", "Yugoslavia", "Bulgaria", "Soviet Union", "Turkey", "Russia")
others <- c("South Africa", "Japan", "South Korea", "Japan, South Korea")
worldcups_tidy <- worldcups %>%
pivot_longer(winner:fourth, names_to = "position_status", values_to = "country_name") %>%
rename(host_country = host) %>%
mutate(host_country = ifelse(host_country == "USA", "United States", host_country),
country_name = ifelse(country_name == "USA", "United States", country_name)) %>% mutate(host_continent = case_when(
host_country %in% americas ~ "Americas",
host_country %in% europe ~ "Europe",
host_country %in%  others ~ "Rest Of World"),
country_continent = case_when(
country_name %in% americas ~ "Americas",
country_name %in% europe ~ "Europe",
country_name %in%  others ~ "Rest Of World"))
wcmatches_tidy <- wcmatches %>%
rename(stage_status = stage, win_outcome = outcome) %>%
mutate(stage_status = ifelse(str_detect(stage_status, "Group"), "Group Stage", stage_status),
stage_status = ifelse(stage_status == "Final Round", "Finals", stage_status)) %>%
select(-date) %>%
mutate(win_outcome = case_when(
home_score == away_score ~ "Draw",
win_outcome == "H" ~ "Home",
win_outcome == "D" ~ "Draw",
win_outcome == "A" ~ "Away")) %>%
mutate(score_difference = abs(home_score - away_score),
win_conditions = replace_na(win_conditions, "Nil"),
after_extra_time = ifelse(str_detect(win_conditions, "AET"), 1, 0),
penalties = ifelse(str_detect(win_conditions, "penalties"), 1, 0))
library(ggplot2)
library(forcats)
wcmatches_updated <- wcmatches_tidy %>%
mutate(win_outcome = ifelse(penalties == 1, "Draw", win_outcome)) %>%
select(home_team, away_team, win_outcome)
# Points for home team or away team win matches
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country) %>%
group_by(country) %>%
summarise(win_points = 3 * n())
# Points for draw matches
wcmatches_draws <- wcmatches_updated %>%
filter(win_outcome == "Draw") %>%
pivot_longer(home_team:away_team) %>%
rename(country = value) %>%
select(country) %>%
group_by(country) %>%
summarise(draw_points = n())
# Join `wc_matches_wins` and `wc_matches_draws` and compute total points for each country.
wcmatches_tabulated <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
arrange(desc(total_points)) %>%
head(10)
# Create a bar plot
ggplot(wcmatches_tabulated, aes(x = fct_reorder(country, total_points), y = total_points)) +
geom_col(fill = "#FF9999") +
coord_flip() +
labs(x = "Country", y = "Total Points", title = "Top 10 Best Performing Countries In World Cup") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_text(label = wcmatches_tabulated$total_points, size = 5, position = position_stack(vjust = 0.5))
library(maps)
world_coordinates = map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
wcmatches_tabulated_two <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
top_countries_joined = world_coordinates %>%
left_join(wcmatches_tabulated_two, by = c("region" = "country"))
ggplot(data = top_countries_joined, mapping = aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
scale_fill_distiller(palette = "Spectral", direction = -1, name = "Total Points") +
theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5)) +
labs(title = "Global Distribution of Total Points obtained across World Cups")
