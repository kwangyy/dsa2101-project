theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(stringr)
library(ggplot2)
library(forcats)
library(maps)
library(ggthemes)
wcmatches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/wcmatches.csv')
worldcups <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv')
americas <- c("Uruguay", "Brazil", "Chile", "Mexico", "Argentina", "United States")
europe <- c("Italy", "France", "Switzerland", "Sweden", "England", "Germany", "Spain", "West Germany", "Netherlands", "Austria", "Belgium", "Croatia", "Czechoslovakia", "Hungary", "Poland", "Portugal", "Yugoslavia", "Bulgaria", "Soviet Union", "Turkey", "Russia")
others <- c("South Africa", "Japan", "South Korea", "Japan, South Korea")
worldcups_tidy <- worldcups %>%
pivot_longer(winner:fourth, names_to = "position_status", values_to = "country_name") %>%
rename(host_country = host) %>%
mutate(host_country = ifelse(host_country == "USA", "United States", host_country),
country_name = ifelse(country_name == "USA", "United States", country_name)) %>%
mutate(host_continent = case_when(
host_country %in% americas ~ "Americas",
host_country %in% europe ~ "Europe",
host_country %in% others ~ "Rest Of World"),
country_continent = case_when(
country_name %in% americas ~ "Americas",
country_name %in% europe ~ "Europe",
country_name %in% others ~ "Rest Of World"))
wcmatches_tidy <- wcmatches %>%
rename(stage_status = stage, win_outcome = outcome) %>%
mutate(stage_status = ifelse(str_detect(stage_status, "Group"), "Group Stage", stage_status),
stage_status = ifelse(stage_status == "Final Round", "Final", stage_status)) %>%
select(-date) %>%
mutate(win_outcome = case_when(
home_score == away_score ~ "Draw",
win_outcome == "H" ~ "Home",
win_outcome == "D" ~ "Draw",
win_outcome == "A" ~ "Away")) %>%
mutate(score_difference = abs(home_score - away_score),
win_conditions = replace_na(win_conditions, "Nil"),
after_extra_time = ifelse(str_detect(win_conditions, "AET"), 1, 0),
penalties = ifelse(str_detect(win_conditions, "penalties"), 1, 0))
wcmatches_updated <- wcmatches_tidy %>%
mutate(win_outcome = ifelse(penalties == 1, "Draw", win_outcome)) %>%
select(home_team, away_team, win_outcome)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country) %>%
group_by(country) %>%
summarise(win_points = 3 * n())
wcmatches_draws <- wcmatches_updated %>%
filter(win_outcome == "Draw") %>%
pivot_longer(home_team:away_team) %>%
rename(country = value) %>%
select(country) %>%
group_by(country) %>%
summarise(draw_points = n())
home_countries <- wcmatches_tidy %>%
select(home_team) %>%
distinct() %>%
rename(country = home_team)
away_countries <- wcmatches_tidy %>%
select(away_team) %>%
distinct() %>%
rename(country = away_team)
wcmatches_allcountries <- rbind(home_countries, away_countries) %>%
distinct()
wcmatches_tabulated <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
full_join(wcmatches_allcountries, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
country == "Dutch West Indies" ~ "Indonesia",
country == "Zaire" ~ "Democratic Republic of the Congo",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
world_map <- map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
region == "Ireland" ~ "Republic of Ireland",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_map, by = c("country" = "region"))
ggplot(top_countries_joined, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradientn(name = "Total Points",
colors = c("#ffffb2", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026"),
na.value = "white") +
borders(colour = "black", size = 0.1) +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(), axis.text = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 90)
viz_3_wcmatches <- wcmatches_tidy %>%
filter(home_team == country | away_team == country) %>%
mutate(home_goal_scored = ifelse(country == home_team, home_score, away_score)) %>%
select(year, home_goal_scored) %>%
group_by(year) %>%
summarize(total_goals_scored = sum(home_goal_scored))
viz_3_worldcups <- worldcups_tidy %>%
rename(country = host_country) %>%
group_by(year, country) %>%
summarize(goals_scored = mean(goals_scored)) %>%
select(year, country, goals_scored)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(unite(year, )) %>% # this is the new line
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year"))
View(viz_3_data)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(host = unite(year, country)) %>% # this is the new line
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, country, goal_proportion)
?unte
?unite
viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(host = unite(vis_3_data, year, country))
viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(host = unite(viz_3_data, year, country))
viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(host = as.factor(unite(viz_3_data, year, country)))
View(viz_3_worldcups)
View(viz_3_wcmatches)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>%
unite(col = host, year:country, sep = "") %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, country, goal_proportion)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>%
unite(col = host, year:country, sep = "")
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>%
unite(col = host, year:country, sep = " ")
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion))
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
geom_line() +
geom_point() +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
geom_line() +
geom_point() +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
geom_line()
viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
geom_line() +
geom_point()
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
geom_line(linewidth = 1) +
geom_point() +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
geom_line(linewidth = 1) +
geom_point() +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
select(year, country, total_goals_scored, goals_scored) %>% # rearrange the columns
unite(col = host, year:country, sep = " ") %>% # unite year and host country for the plot
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(host, goal_proportion) %>%
ggplot(aes(x = host, y = goal_proportion)) +
#scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
geom_line() +
geom_point() +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_wcmatches <- wcmatches_tidy %>%
filter(home_team == country | away_team == country) %>%
mutate(home_goal_scored = ifelse(country == home_team, home_score, away_score)) %>%
select(year, home_goal_scored) %>%
group_by(year) %>%
summarize(total_goals_scored = sum(home_goal_scored))
viz_3_worldcups <- worldcups_tidy %>%
rename(country = host_country) %>%
group_by(year, country) %>%
summarize(goals_scored = mean(goals_scored)) %>%
select(year, country, goals_scored)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
viz_3_wcmatches <- wcmatches_tidy %>%
filter(home_team == country | away_team == country) %>%
mutate(home_goal_scored = ifelse(country == home_team, home_score, away_score)) %>%
select(year, home_goal_scored) %>%
group_by(year) %>%
summarize(total_goals_scored = sum(home_goal_scored))
viz_3_worldcups <- worldcups_tidy %>%
rename(country = host_country) %>%
group_by(year, country) %>%
summarize(goals_scored = mean(goals_scored)) %>%
select(year, country, goals_scored)
viz_3_data <- viz_3_wcmatches %>% left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
geom_line() +
geom_point() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
?geom_line
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(stringr)
library(ggplot2)
library(forcats)
library(maps)
library(ggthemes)
wcmatches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/wcmatches.csv')
worldcups <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv')
americas <- c("Uruguay", "Brazil", "Chile", "Mexico", "Argentina", "United States")
europe <- c("Italy", "France", "Switzerland", "Sweden", "England", "Germany", "Spain", "West Germany", "Netherlands", "Austria", "Belgium", "Croatia", "Czechoslovakia", "Hungary", "Poland", "Portugal", "Yugoslavia", "Bulgaria", "Soviet Union", "Turkey", "Russia")
others <- c("South Africa", "Japan", "South Korea", "Japan, South Korea")
worldcups_tidy <- worldcups %>%
pivot_longer(winner:fourth, names_to = "position_status", values_to = "country_name") %>%
rename(host_country = host) %>%
mutate(host_country = ifelse(host_country == "USA", "United States", host_country),
country_name = ifelse(country_name == "USA", "United States", country_name)) %>%
mutate(host_continent = case_when(
host_country %in% americas ~ "Americas",
host_country %in% europe ~ "Europe",
host_country %in% others ~ "Rest Of World"),
country_continent = case_when(
country_name %in% americas ~ "Americas",
country_name %in% europe ~ "Europe",
country_name %in% others ~ "Rest Of World"))
wcmatches_tidy <- wcmatches %>%
rename(stage_status = stage, win_outcome = outcome) %>%
mutate(stage_status = ifelse(str_detect(stage_status, "Group"), "Group Stage", stage_status),
stage_status = ifelse(stage_status == "Final Round", "Final", stage_status)) %>%
select(-date) %>%
mutate(win_outcome = case_when(
home_score == away_score ~ "Draw",
win_outcome == "H" ~ "Home",
win_outcome == "D" ~ "Draw",
win_outcome == "A" ~ "Away")) %>%
mutate(score_difference = abs(home_score - away_score),
win_conditions = replace_na(win_conditions, "Nil"),
after_extra_time = ifelse(str_detect(win_conditions, "AET"), 1, 0),
penalties = ifelse(str_detect(win_conditions, "penalties"), 1, 0))
wcmatches_updated <- wcmatches_tidy %>%
mutate(win_outcome = ifelse(penalties == 1, "Draw", win_outcome)) %>%
select(home_team, away_team, win_outcome)
wcmatches_wins <- wcmatches_updated %>%
filter(win_outcome %in% c("Home", "Away")) %>%
mutate(country = ifelse(win_outcome == "Home", home_team, away_team)) %>%
select(country) %>%
group_by(country) %>%
summarise(win_points = 3 * n())
wcmatches_draws <- wcmatches_updated %>%
filter(win_outcome == "Draw") %>%
pivot_longer(home_team:away_team) %>%
rename(country = value) %>%
select(country) %>%
group_by(country) %>%
summarise(draw_points = n())
home_countries <- wcmatches_tidy %>%
select(home_team) %>%
distinct() %>%
rename(country = home_team)
away_countries <- wcmatches_tidy %>%
select(away_team) %>%
distinct() %>%
rename(country = away_team)
wcmatches_allcountries <- rbind(home_countries, away_countries) %>%
distinct()
wcmatches_tabulated <- wcmatches_wins %>%
full_join(wcmatches_draws, by = "country") %>%
full_join(wcmatches_allcountries, by = "country") %>%
mutate(win_points = replace_na(win_points, 0),
draw_points = replace_na(draw_points, 0),
total_points = win_points + draw_points) %>%
select(country, total_points) %>%
mutate(country = case_when(
country == "West Germany" ~ "Germany",
country == "East Germany" ~ "Germany",
country == "Soviet Union" ~ "Russia",
country == "Yugoslavia" ~ "Serbia",
country == "FR Yugoslavia" ~ "Serbia",
country == "Czechoslovakia" ~ "Czech Republic",
country == "Dutch West Indies" ~ "Indonesia",
country == "Zaire" ~ "Democratic Republic of the Congo",
.default = country)) %>%
group_by(country) %>%
summarise(total_points = sum(total_points))
world_map <- map_data("world") %>%
mutate(region = case_when(
region == "USA" ~ "United States",
region == "China" ~ "China PR",
region == "Ireland" ~ "Republic of Ireland",
subregion == "Scotland" ~ "Scotland",
subregion == "Great Britain" ~ "England",
subregion == "Isle of Wight" ~ "England",
subregion == "Wales" ~ "Wales",
subregion == "Northern Ireland" ~ "Northern Ireland",
.default = region)) %>%
select(-subregion)
top_countries_joined <- wcmatches_tabulated %>%
full_join(world_map, by = c("country" = "region"))
ggplot(top_countries_joined, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = total_points)) +
labs(title = "Global Distribution of Total Points obtained across World Cups (1930-2018)") +
scale_fill_gradientn(name = "Total Points",
colors = c("#ffffb2", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026"),
na.value = "white") +
borders(colour = "black", size = 0.1) +
theme_minimal() +
theme(legend.position = "bottom", axis.title = element_blank(), axis.text = element_blank(),
panel.grid = element_blank(), plot.title = element_text(hjust = 0.5)) +
ylim(-60, 90)
viz_3_wcmatches <- wcmatches_tidy %>%
filter(home_team == country | away_team == country) %>%
mutate(home_goal_scored = ifelse(country == home_team, home_score, away_score)) %>%
select(year, home_goal_scored) %>%
group_by(year) %>%
summarize(total_goals_scored = sum(home_goal_scored))
viz_3_worldcups <- worldcups_tidy %>%
rename(country = host_country) %>%
group_by(year, country) %>%
summarize(goals_scored = mean(goals_scored)) %>%
select(year, country, goals_scored)
viz_3_data <- viz_3_wcmatches %>%
left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
geom_line() +
geom_point() +
scale_x_continuous(breaks = seq(1930, 2018, 4)) +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
wcmatches_tidy
worldcups_tidy
?geom_line
viz_3_data <- viz_3_wcmatches %>%
left_join(viz_3_worldcups, by = c("year" = "year")) %>%
mutate(goal_proportion = (total_goals_scored / goals_scored) * 100) %>%
select(year, country, goal_proportion) %>%
ggplot(aes(x = year, y = goal_proportion)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = scales::label_number(suffix = "%")) +
labs(title = "Proportion of Goals scored by Host Countries (1930-2018)",
subtitle = "Goals scored by host country as a percentage of total goals scored",
x = "", y = "Proportion of Goals Scored") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
viz_3_data
